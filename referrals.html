<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Referral Management - Panda Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-success shadow">
        <div class="container">
            <a class="navbar-brand" href="./"><img src="panda-logo.png" alt="Panda" style="height: 40px;"></a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="dashboard.html">Employees</a>
                <a class="nav-link" href="leads.html">Leads</a>
                <a class="nav-link active" href="referrals.html">Referrals</a>
                <a class="nav-link" href="assets.html">Assets</a>
                <a class="nav-link" href="admin.html">Admin</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1><i class="fas fa-handshake text-success"></i> Referral Management</h1>
        
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-primary text-white">
                    <div class="card-body text-center">
                        <h3 id="totalReferrals">0</h3>
                        <p>Total Referrals</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body text-center">
                        <h3 id="convertedReferrals">0</h3>
                        <p>Converted</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-warning text-dark">
                    <div class="card-body text-center">
                        <h3 id="pendingReferrals">0</h3>
                        <p>Pending</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-info text-white">
                    <div class="card-body text-center">
                        <h3 id="conversionRate">0%</h3>
                        <p>Conversion Rate</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header d-flex justify-content-between">
                <h5>Referral List</h5>
                <button class="btn btn-success" onclick="addReferral()">Add Referral</button>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Referrer</th>
                                <th>Customer Name</th>
                                <th>Contact</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="referralsTable">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://4ytrdf6rpklojh5c52gxpf5iei0winqx.lambda-url.us-east-2.on.aws';
        
        const sampleReferrals = [
            { id: 1, referrer: 'John Smith', customer: 'Mike Johnson', contact: '555-0123', status: 'Converted', date: '2025-09-20' },
            { id: 2, referrer: 'Sarah Wilson', customer: 'Lisa Brown', contact: '555-0124', status: 'Pending', date: '2025-09-22' },
            { id: 3, referrer: 'Bob Davis', customer: 'Tom Wilson', contact: '555-0125', status: 'Contacted', date: '2025-09-25' }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            loadReferrals();
        });

        function loadReferrals() {
            const tbody = document.getElementById('referralsTable');
            tbody.innerHTML = '';
            
            let total = sampleReferrals.length;
            let converted = sampleReferrals.filter(r => r.status === 'Converted').length;
            let pending = sampleReferrals.filter(r => r.status === 'Pending').length;
            
            document.getElementById('totalReferrals').textContent = total;
            document.getElementById('convertedReferrals').textContent = converted;
            document.getElementById('pendingReferrals').textContent = pending;
            document.getElementById('conversionRate').textContent = total > 0 ? Math.round((converted/total)*100) + '%' : '0%';
            
            sampleReferrals.forEach(referral => {
                const statusClass = referral.status === 'Converted' ? 'success' : 
                                  referral.status === 'Pending' ? 'warning' : 'info';
                
                tbody.innerHTML += `
                    <tr>
                        <td>${referral.referrer}</td>
                        <td>${referral.customer}</td>
                        <td>${referral.contact}</td>
                        <td><span class="badge bg-${statusClass}">${referral.status}</span></td>
                        <td>${referral.date}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" onclick="viewReferral(${referral.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
        }

        function addReferral() {
            alert('Add referral functionality - integrate with CRM system');
        }

        function viewReferral(id) {
            const referral = sampleReferrals.find(r => r.id === id);
            alert(`Referral Details:\nReferrer: ${referral.referrer}\nCustomer: ${referral.customer}\nStatus: ${referral.status}`);
        }
    </script>
</body>
</html>