let employees=[];let terminatedEmployees=[];let mergedEmployeeIds=new Set(JSON.parse(localStorage.getItem('mergedEmployeeIds')||'[]'));const API_BASE='https://w40mq6ab11.execute-api.us-east-2.amazonaws.com/prod';async function loadEmployees(){try{const response=await fetch(`${API_BASE}/employees`);const data=await response.json();console.log('Raw API response:',data);if(data.employees){let allEmployees=data.employees.filter(emp=>!mergedEmployeeIds.has(emp.employee_id));allEmployees.forEach(emp=>{if(!emp.employee_id&&emp['First Name']&&emp['Last Name']){emp.employee_id=generateEmployeeId(emp['First Name'],emp['Last Name'])}});employees=allEmployees.filter(emp=>emp.Terminated!=='Yes');terminatedEmployees=allEmployees.filter(emp=>emp.Terminated==='Yes');console.log('Active employees:',employees.length);console.log('Terminated employees:',terminatedEmployees.length);renderEmployeeTable()}}catch(error){console.error('Load failed:',error)}}function renderEmployeeTable(){const tbody=document.getElementById('employeeTableBody');tbody.innerHTML='';let newHireCount=0,newHires1to30=0,newHires31to60=0,newHires61to90=0;const today=new Date();const thirtyDaysAgo=new Date(today.getTime()-30*24*60*60*1000);const sixtyDaysAgo=new Date(today.getTime()-60*24*60*60*1000);const ninetyDaysAgo=new Date(today.getTime()-90*24*60*60*1000);employees.forEach((emp,index)=>{const empDate=new Date(emp['Employment Date']);if(empDate>ninetyDaysAgo&&empDate<=today){newHireCount++;if(empDate>thirtyDaysAgo)newHires1to30++;else if(empDate>sixtyDaysAgo)newHires31to60++;else newHires61to90++}const row=document.createElement('tr');row.innerHTML=`<td><input type="checkbox" class="employee-select" data-index="${index}"></td><td>${emp['First Name']||''}</td><td>${emp['Last Name']||''}</td><td>${emp.Department||''}</td><td>${emp.Position||''}</td><td>${emp['Employment Date']||''}</td><td>${emp['Years of Service']||''}</td><td>${emp.Email||''}</td><td>${emp.Phone||''}</td><td>${emp['Merch Requested']||''}</td><td>${emp['Merch Sent']||'No'}</td><td><button class="btn" onclick="editEmployee(${index})">Edit</button></td>`;tbody.appendChild(row)});document.getElementById('totalEmployees').textContent=employees.length;document.getElementById('newHires').textContent=newHireCount;document.getElementById('newHires1to30').textContent=newHires1to30;document.getElementById('newHires31to60').textContent=newHires31to60;document.getElementById('newHires61to90').textContent=newHires61to90}function showTab(tabName){document.querySelectorAll('.tab-content').forEach(tab=>tab.classList.remove('active'));document.querySelectorAll('.nav-tab').forEach(tab=>tab.classList.remove('active'));document.getElementById(tabName).classList.add('active');document.querySelector(`[data-tab="${tabName}"]`).classList.add('active')}function generateEmployeeId(firstName,lastName){const first=(firstName||'').substring(0,2).toUpperCase();const last=(lastName||'').substring(0,2).toUpperCase();const timestamp=Date.now().toString().slice(-4);return`${first}${last}${timestamp}`}function editEmployee(index){console.log('Edit employee:',employees[index])}function toggleSelectAllEmployees(){}function sortTable(){}document.addEventListener('DOMContentLoaded',function(){document.querySelectorAll('.nav-tab').forEach(tab=>{tab.addEventListener('click',()=>showTab(tab.dataset.tab))});loadEmployees();showTab('employees')});